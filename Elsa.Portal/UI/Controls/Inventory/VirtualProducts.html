<div class="panel w4" id="virtualProductsEditorPanel">
    <div class="panelContent" id="vpsUi">
        <div id="vpsSearch">
            <div class="searchPanel" style="width:100%">
                <input type="text" id="tbVpsQuery" />
                <button event-bind="click:search($tbVpsQuery.value)" class="fa fa-search"></button>
            </div>
        </div>
        <div >
            <button event-bind="click:createNewVp"><i class="fas fa-plus"></i></button>
            <div id="vpsList">

                <div lt-name="vpItemTemplate" class="vpsContainer">
                    <div data-bind="class.hidden:editMode" class="virtualProductItemView">
                        <i class="fas fa-edit faButton"  event-bind="click:editVp(VirtualProductId)"></i>
                        <div data-bind="text:Name" class="vpsTitle"></div>
                    </div>
                    <div data-bind="class!.hidden:editMode" class="virtualProductEditItem">
                        <i class="fas fa-hashtag"></i>
                        <input data-bind="value:Name" />
                        
                        <div class="itemEditFoot">
                            <button><i class="fas fa-check"></i></button>
                            <button event-bind="click:cancelEdit"><i class="fas fa-times"></i></button>
                        </div>

                    </div>

                </div>

            </div>
        </div>
    </div>

</div>

<script>
    lt.element("virtualProductsEditorPanel").withModel("app.virtualProductsEditor.vm").attach(function (vpsList, vpItemTemplate) {

        var vpItemController = function() {
            
        };

        this.bind(function (selectedVirtualProducts) {

            lt.generate(vpsList,
                vpItemTemplate,
                selectedVirtualProducts,
                function(vp) { return vp.VirtualProductId; },
                vpItemController());
        });

        this.search = function(query) {
            app.virtualProductsEditor.vm.loadVirtualProducts(query);
        };

        this.editVp = function(vpid) {
            app.virtualProductsEditor.vm.setVirtualProductEdit(vpid);
        };

        this.createNewVp = function() {
            app.virtualProductsEditor.vm.setVirtualProductEdit(-1);
        };

        this.cancelEdit = function() {
            app.virtualProductsEditor.vm.cancelVpEdit();
        };

    });
</script>