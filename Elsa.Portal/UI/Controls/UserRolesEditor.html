<div id="roleEditor">
    <div class="stackLeft childrenTop">
        <div class="pnlUserRoles">
            <div data-bind="itemsSource:userRoles" data-key="Id" template-url="/UI/Controls/UserRoleTreeItem.html"></div>
        </div>
        <div class="pnlUserRights">
            <div data-bind="itemsSource:roleRights" data-key="Symbol" template-url="/UI/Controls/UserRightTreeItem.html"></div>
        </div>
        <div class="pnlUserRights">
            <div data-bind="itemsSource:roleUsers" data-key="Id">
                <div class="lt-template">
                    <div data-bind="text:Name"></div>
                </div>
            </div>
        </div>
    </div>
<script>

    lt.element("roleEditor").withModel("app.userRoles.vm").attach(function () {

        this.selectRole = function(roleId) {
            app.userRoles.vm.selectRole(roleId);
        };

        this.addChildRole = function(parentRoleId) {
            var result = prompt("Název nové role");
            if (!result) {
                return;
            }

            result = result.trim();
            if (result.length < 1) {
                alert("Název nemůže být prázdný");
                return;
            }

            app.userRoles.vm.addChildRole(parentRoleId, result);
        };

        this.renameRole = function(roleId, oldName) {
            var result = prompt("Nový název", oldName);
            if (!result) {
                return;
            }

            result = result.trim();
            if (result.length < 1) {
                alert("Název nemůže být prázdný");
                return;
            }

            app.userRoles.vm.renameRole(roleId, result);
        };

        this.deleteRole = function(id, name) {
            if (!confirm("Opravdu chcete vymazat roli '" + name + "'?")) {
                return;
            }

            app.userRoles.vm.deleteRole(id);
        };

        this.onRightAssignmentChange = function(symbol, currentValue) {

            app.userRoles.vm.changeRoleRightAssignment(symbol, !currentValue);

        };

    });

</script>
<link href="/UI/Style/UserEditor.css" rel="stylesheet" />